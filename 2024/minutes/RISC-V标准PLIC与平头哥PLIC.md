# RISC-V标准PLIC与平头哥PLIC

## RISC-V标准PLIC

RISC-V标准PLIC实现支持1023个中断源、15872个上下文。

链接：https://github.com/riscv/riscv-plic-spec/blob/master/riscv-plic-1.0.0.pdf

内存布局

| 基地址 | 末尾地址 | 类型 | 含义 |
|:-----|:-----|:-----|:-----|
| 0x000000 | 0x000FFC | `[u32; 1024]` | 中断0至1023的优先级（实际上只有1至1023，因为中断源0不存在） | 
| 0x001000 | 0x00107C | `[u32; 32]` | 中断0至1023的待办位 |
| 0x002000 | 0x00207C | `[u32; 32]` | 上下文0中，中断源0至1023的启用位 |
| 0x002080 | 0x0020FC | `[u32; 32]` | 上下文1中，中断源0至1023的启用位 |
| .. | .. | `[u32; 32]` | 上下文 .. 中，中断源0至1023的启用位 |
| 0x1F1F80 | 0x1F1FFC | `[u32; 32]` | 上下文15871中，中断源0至1023的启用位 |
| 0x1F2000 | 0x1FFFFC | `[u8; 0xe000]` | _保留_ |
| 0x200000 | 0x200000 | `u32` | 上下文0的优先级阈值 |
| 0x200004 | 0x200004 | `u32` | 上下文0的认领和完成位 |
| 0x200008 | 0x200FFC | `[u8; 4088]` | _保留_ |
| 0x201000 | 0x201000 | `u32` | 上下文1的优先级阈值 |
| 0x201004 | 0x201004 | `u32` | 上下文1的认领和完成位 |
| 0x201008 | 0x201FFC | `[u8; 4088]` | _保留_ |
| .. | .. | `u32` | .. |
| 0x3FFF000 | 0x3FFF000 | `u32` | 上下文15871的优先级阈值 |
| 0x3FFF004 | 0x3FFF004 | `u32` | 上下文15871的认领和完成位 |
| 0x3FFF008 | 0x3FFFFFC | `[u8; 4088]` | _保留_ |

标准PLIC的内存块长度是0x4000000。

## 平头哥C906 PLIC

优先级寄存器、优先级阈值寄存器最低5位可写，即支持0..=31共32个不同的优先级。平头哥C906 PLIC支持1023个中断源，2个上下文（其中1个核，每个核2个上下文）。

与RISC-V标准PLIC的变化如下：
| 基地址 | 末尾地址 | 类型 | 含义 |
|:-----|:-----|:-----|:-----|
| 0x1FFFFC | 0x1FFFFC | `u32` | PLIC_CTRL权限控制寄存器。最低位S_PER为访问权限控制位，当为0时仅M态能访问PLIC控制器权限，S态仅能访问S态优先级阈值和认领和完成位；为1时S态能访问除PLIC_CTRL外所有寄存器。U态无访问PLIC权限。 |
